from creatures import Monster, Player
from encounter import Encounter
import pandas as pd
import cli_template
import subprocess

# file paths
dnd_monsters_path = "./ref/dnd_monsters.csv"
cr_xp_table_path = "./ref/cr_xp_table.csv"
xp_threshold_by_level_path = "./.ref/xp_threshold_by_level.csv"


all_monsters = pd.read_csv(dnd_monsters_path)
all_monster_challenge_rating = pd.Series(
    all_monsters['cr'].values,
    index=all_monsters['name'].values,
    name='challenge rating'
)

cr_to_xp_table = pd.read_csv(cr_xp_table_path)
cr_to_xp_series = pd.Series(
    cr_to_xp_table['xp'].values,
    index=cr_to_xp_table['cr'].values,
    name='Challenge Rating x XP'
)

xp_threshold_by_level = pd.read_csv(xp_threshold_by_level_path).T


def main():

    num_players_input = int(input("How many players are in the party? "))
    num_mosnter_input = int(input("How many monsters are in this encounter? "))
    players = []
    monsters = []

    for player in range(num_players_input):
        name = input(f"Please enter player {player + 1}'s character name: ")
        level = int(
            input(f"Please enter player {player + 1}'s character level: "))
        players.append(Player(name, level))

    for monster in range(num_mosnter_input):
        name = input("Which monster would you like to add to the encounter? ")
        num = int(input(f"How many {name}'s would you like to add? "))
        for i in range(num):
            monsters.append(Monster(name))

    encounter = Encounter(monsters, players)

    print(f'Chracater XP Thresholds: \n{encounter.total_xp_threshold}')
    print(f'Encounter difficulty: {encounter.difficulty}')
    print(f'Adjusted combat XP: {encounter.total_monster_xp}')


if __name__ == "__main__":
    main()
